How to make a new release

Main steps :

1. Tag the CVS tree

2. build a tarball

3. make the tarball available on SourceForge


Detailed steps :

1. Tag the CVS tree

From the top-level 'rosegarden' directory :
cvs tag <RELEASE_NAME> .

Note that release names can't contain dots. For instance :

cvs tag RELEASE_0_1 .

2. Bulding the tarball

From the top level source dir :

- edit configure.in.in and set the version number on the line AM_INIT_AUTOMAKE
- do 'make -f Makefile.cvs; make clean'

Clone (cp -R) the whole directory tree to another dir, named
rosegarden-$version (for instance, rosegarden-0.1).

cd to that new directory and do 'make dist'

NOTE : 'make dist' uses the output of `cd $PWD` and will get it wrong
if your CDPATH contains '..'. This causes 'make dist' to fail with a
message like :

---------
automake: /home/glaurent/tmp/rosegarden-0.1.2/rosegarden-0.1.2.am:
`/home/glaurent/tmp/rosegarden-0.1.2/rosegarden-0.1.2.am' does not
exist
---------

in which case the simplest thing to do is to unset CDPATH and restart
'make dist'. You may also get errors about missing rules for some
targets, like :

---------
make[1]: *** No rule to make target `../sound/libRosegardenSequencer.la', needed by `rosegardensequencer'.  Stop.
make[1]: Leaving directory `/home/glaurent/tmp/rosegarden-0.1.2/sequencer'
make: *** [distdir] Error 1
zsh: exit 2     make dist
---------

For the moment the only known way out of this is to simply do a 'make'
first, then restarting 'make dist'. IMPORTANT : in that case make sure the
various binaries ('gui/rosegarden', 'sequencer/rosegardensequencer')
aren't included in the final tarball.

The tarball should be built in the new directory, that is at
rosegarden-0.1/rosegarden-0.1.tar.gz


ADDENDUM : the above problems (missing target, binaries being left in the tarball) appear to be solved by
make distclean ; sh ./gl_configure ; make dist


3. making the tarball available on SourceForge

This is the rather non-trivial step.

- copy the tarball to ftp://upload.sf.net/incoming/ (anon-ftp)
- log on to SourceForge
- go to the 'admin' page of Rosegarden, then to the 'Edit/Release files' page.
  The direct URL should be :
  https://sourceforge.net/project/admin/editpackages.php?group_id=4932

- go to QRS - Quick Release a File

- fill up the form. The package name is 'rosegarden', the release name
  should simply be the version number. For the file name, you're
  offerred a selection among the lists of the files recently uploaded
  (on upload.sf.net). DO NOT select another one than the one you just
  uploaded (yes, you can actually "release" files which have nothing
  to do with the project, and this whole system suck quite a bit).

That's it, the file will be effectively available within the next few
hours.
