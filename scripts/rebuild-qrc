#!/bin/bash
#
# rebuild-qrc
#
# Copyright (c) 2009  D. Michael McIntyre <rosegarden.trumpeter@gmail.com>
# Released under the GPL
#
# REQUIRES: 
#
#
# PURPOSE: Having to edit data.qrc by hand every time I add a file is annoying,
# and so I decided to write a script to assemble a .qrc file for me.  I'm
# surprised there wasn't one already.
#
#
#

pushd .
cd data

if [ "$(basename $PWD)" != "data" ]; then
    echo $0 must be run from the data/ directory!
    exit 1
fi

ofile=data.qrc

writeEntries() {
    echo Assembling files of type $1...
    for f in $(find . -name \*.$1); do
    cat >> $ofile << EOF
<file>$f</file>
EOF
    done
}

cat > $ofile << EOF
<!DOCTYPE RCC>
<RCC version="1.0">
<!--

WARNING! This file was created automatically by $0

Do not edit this file by hand.  All changes will be LOST!
-->
<qresource>
EOF

for ext in pfa png qss rc rg rgd xml xpm; do
    writeEntries $ext
done

cat >> $ofile << EOF
</qresource>
</RCC>
EOF


echo Success!
popd

exit 0
