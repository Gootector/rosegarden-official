#MIN_CONFIG

AM_INIT_AUTOMAKE(rosegarden,0.1.4)

dnl These are common macros that you might or might not want to use

dnl Image readers/writers
KDE_CHECK_KIMGIO
 
dnl Checks for header files.
AC_HEADER_DIRENT
AC_HEADER_STDC
AC_HEADER_TIME
AC_CHECK_HEADERS(fcntl.h sys/time.h unistd.h stdlib.h paths.h)
AC_CHECK_FILE($kde_includes/arts/reference.h,, AC_MSG_ERROR("aRTS headers are missing"))
AC_CHECK_FUNCS(usleep)

dnl check whether user wants to use ALSA
AC_ARG_WITH(alsa, [  --with-alsa             enable ALSA support (at cost of aRts support)],
[
   if test $withval = "yes"; then
     with_alsa=yes
   else
     with_alsa=no
  fi
], with_alsa=no)

dnl only use ALSA when sys/soundlib.h is found
if test "$ac_header_sys_soundlib_h" = "no"; then
  with_alsa=no
fi

dnl and libasound is present
if test "$with_alsa" = "yes"; then
  AC_CHECK_LIB(asound,snd_seq_create_simple_port,
               LIBASOUND="-lasound",with_alsa=no)
fi
AC_SUBST(LIBASOUND)

if test "$with_alsa" = "yes"; then
  AC_DEFINE(HAVE_ALSA, 1, [Define if you have ALSA support])
fi

dnl check whether user wants to use JACK
AC_ARG_WITH(jack, [  --with-jack             enable JACK support (must have ALSA support as well)],
[
   if test $withval = "yes"; then
     with_jack=yes
   else
     with_jack=no
  fi
], with_jack=no)

dnl only use JACK when jack/jack.h is found
if test "$ac_header_jack_jack_h" = "no"; then
  with_jack=no
fi

if test "$with_jack" = "yes"; then
  AC_DEFINE(HAVE_JACK, 1, [Define if you have JACK support])
  AC_SUBST(JACKLIB)
  AC_CHECK_FUNCS(libRosegardenSequencer.la, [],
                 [JACKLIB="-ljack"])
fi


